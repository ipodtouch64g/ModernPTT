(this.webpackJsonpmodernptt=this.webpackJsonpmodernptt||[]).push([[0],{114:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.SelectQueryBuilder=void 0;var a=n(r(41)),i=n(r(52)),s=n(r(53)),o=n(r(40));function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=c(r);function r(){(0,a.default)(this,r);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.call.apply(t,[this].concat(n))}return r}(r(240).QueryBuilder);t.SelectQueryBuilder=u},135:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(113)),i=n(r(41)),s=n(r(71)),o=n(r(51)),c=n(r(52)),u=n(r(53)),l=n(r(40)),f=n(r(72));function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var h=function(e){(0,c.default)(r,e);var t=d(r);function r(e){var n;return(0,i.default)(this,r),n=t.call(this),(0,f.default)((0,o.default)(n),"_config",void 0),(0,f.default)((0,o.default)(n),"_socket",void 0),n._config=e,n}return(0,s.default)(r,[{key:"connect",value:function(){var e,t=this;if("undefined"===typeof WebSocket)throw new Error("'WebSocket' is undefined. Do you include any websocket polyfill?");if(1===WebSocket.length)e=new WebSocket(this._config.url),console.log("WebSocket 1",e,this._config);else{var r={};this._config.origin&&(r.origin=this._config.origin),e=new WebSocket(this._config.url,r)}e.addEventListener("open",this.emit.bind(this,"connect")),e.addEventListener("close",this.emit.bind(this,"disconnect")),e.addEventListener("error",this.emit.bind(this,"error"));var n,i=[];e.binaryType="arraybuffer",e.addEventListener("message",(function(e){var r,s=e.data;if(clearTimeout(n),(r=i).push.apply(r,(0,a.default)(new Uint8Array(s))),n=setTimeout((function(){t.emit("message",i),i=[]}),t._config.timeout),s.byteLength>t._config.blobSize)throw new Error("Receive message length(".concat(s.byteLength,") greater than buffer size(").concat(t._config.blobSize,")"))})),this._socket=e}},{key:"disconnect",value:function(){this._socket.close()}},{key:"send",value:function(e){var t=this._socket;1===t.readyState&&t.send(e)}}]),r}(n(r(122)).default);t.default=h},140:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"PTT",url:"wss://ws.ptt.cc/bbs",charset:"utf8",origin:"app://pcman",protocol:"websocket",timeout:200,blobSize:1024,preventIdleTimeout:30,terminal:{columns:80,rows:24},numOfPagesPerIteration:2};t.default=n},149:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"ptt",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return s.default}});var a=n(r(186)),i=n(r(234)),s=n(r(135))},179:function(e,t,r){e.exports=r(265)},184:function(e,t,r){},186:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"bot",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i.default}});var a=n(r(187)),i=n(r(140))},187:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(121)),i=n(r(188)),s=n(r(85)),o=n(r(86)),c=n(r(41)),u=n(r(51)),l=n(r(71)),f=n(r(52)),d=n(r(53)),h=n(r(40)),p=n(r(72)),m=n(r(122)),b=n(r(193)),v=n(r(194)),y=n(r(135)),g=r(89),x=r(90),k=n(r(140));function w(e,t){w=function(e,t){return new o(e,void 0,t)};var r=(0,i.default)(RegExp),n=RegExp.prototype,s=new WeakMap;function o(e,t,n){var a=r.call(this,e,t);return s.set(a,n||s.get(e)),a}function c(e,t){var r=s.get(t);return Object.keys(r).reduce((function(t,n){return t[n]=e[r[n]],t}),Object.create(null))}return(0,f.default)(o,r),o.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=c(t,this)),t},o.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var r=s.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+r[t]})))}if("function"===typeof t){var i=this;return n[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==(0,a.default)(e[e.length-1])&&e.push(c(e,i)),t.apply(this,e)}))}return n[Symbol.replace].call(this,e,t)},w.apply(this,arguments)}function E(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(e,t)}(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,p.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.default)(e);if(t){var a=(0,h.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,d.default)(this,r)}}var B=function(e){(0,f.default)(r,e);var t=C(r);function r(e){var n;return(0,c.default)(this,r),n=t.call(this),(0,p.default)((0,u.default)(n),"config",void 0),(0,p.default)((0,u.default)(n),"term",void 0),(0,p.default)((0,u.default)(n),"_state",void 0),(0,p.default)((0,u.default)(n),"currentCharset",void 0),(0,p.default)((0,u.default)(n),"socket",void 0),(0,p.default)((0,u.default)(n),"preventIdleHandler",void 0),(0,p.default)((0,u.default)(n),"getLine",(function(e){return n.term.state.getLine(e)})),n.config=j(j({},k.default),e),n.init(),n}return(0,l.default)(r,[{key:"line",get:function(){for(var e=[],t=0;t<this.term.state.rows;t++){var r=this.term.state.getLine(t),n=r.str,a=r.attr;e.push({str:n,attr:Object.assign({},a)})}return e}},{key:"screen",get:function(){return this.line.map((function(e){return e.str})).join("\n")}}]),(0,l.default)(r,[{key:"reconnect",value:function(){this.socket.connect()}},{key:"init",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,n,a=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.config,this.term=new v.default(t.terminal),this._state=j({},r.initialState),this.term.state.setMode("stringWidth","dbcs"),this.currentCharset="big5",e.t0=t.protocol.toLowerCase(),e.next="websocket"===e.t0||"ws"===e.t0||"wss"===e.t0?8:("telnet"===e.t0||e.t0,9);break;case 8:return e.abrupt("break",11);case 9:throw new Error("Invalid protocol: ".concat(t.protocol));case 11:(n=new y.default(t)).connect(),r.forwardEvents.forEach((function(e){n.on(e,a.emit.bind(a,e))})),n.on("connect",(function(){a._state.connect=!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a.emit.apply(a,["connect"].concat(t)),a.emit("stateChange",a.state)})).on("disconnect",(function(e){a._state.connect=!1,a._state.login=!1;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.emit.apply(a,["disconnect",e].concat(r)),a.emit("stateChange",a.state)})).on("message",(function(e){a.currentCharset!==a.config.charset&&!a.state.login&&(0,g.decode)(e,"utf8").includes("\u767b\u5165\u4e2d\uff0c\u8acb\u7a0d\u5019...")&&(a.currentCharset=a.config.charset);var t=(0,g.decode)(e,a.currentCharset);a.term.write(t),a.emit("redraw",a.term.toString())})).on("error",(function(e){console.error(e)})),this.socket=n;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getContentIterator",value:function(){var e=this,t=this.line[23].str,r=Number(t.substring(t.indexOf("\u7b2c")+2,t.indexOf("\u9801")-1).split("/")[1]);console.log("pgtotal",r);var n=!1,a=!0,i=0,c=[];return c.push(this.line[0]),{reset:function(){i=0,n=!1,a=!0},next:function(){var u=(0,o.default)(s.default.mark((function o(){var u,l,f,d,h,p,m;return s.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,!n&&!t.includes("\u6b64\u6587\u7ae0\u7121\u5167\u5bb9")){s.next=3;break}return s.abrupt("return",{value:null,done:!0});case 3:u=0;case 4:if(!(u<e.config.numOfPagesPerIteration)||n){s.next=24;break}for(t=e.line[23].str,l=Number(t.substring(t.indexOf("\u7b2c")+2,t.indexOf("\u9801")-1).split("/")[0]),console.log("pgNow",l),void 0,console.log("infoline",t),f=t.substring(t.lastIndexOf("\u7b2c")+2,t.indexOf("\u884c")-1).split("~").map(Number),console.log("l",f),d=a?f[0]:f[0]+1,h=1;h<=22;d++,h++)p=e.line[h],d>i&&(c.push(p),i++,console.log("line ",d,", index ",i," ",p));if(a=!1,l!==r){s.next=19;break}n=!0,s.next=21;break;case 19:return s.next=21,e.send("".concat(g.keymap.PgDown));case 21:u++,s.next=4;break;case 24:if(n)for(;c.length>0&&""===c[c.length-1].str;)i--,c.pop();return m={value:c,done:!1},c=[],s.abrupt("return",m);case 30:return s.prev=30,s.t0=s.catch(0),s.abrupt("return",Promise.reject(s.t0));case 33:case"end":return s.stop()}}),o,null,[[0,30]])})));return function(){return u.apply(this,arguments)}}()}}},{key:"getContent",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,r,n,a,i,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=[]).push(this.line[0]),r=!1;case 3:if(this.line[23].str.includes("100%")||this.line[23].str.includes("\u6b64\u6587\u7ae0\u7121\u5167\u5bb9")){e.next=10;break}for(n=1;n<23;n++)t.push(this.line[n]);return e.next=7,this.send(g.keymap.PgDown);case 7:r=!0,e.next=3;break;case 10:a=t[t.length-1],i=0;case 12:if(!(i<23)){e.next=19;break}if(this.line[i].str!==a.str){e.next=16;break}for(o=i+1;o<23;o++)t.push(this.line[o]);return e.abrupt("break",19);case 16:i++,e.next=12;break;case 19:for(;t.length>0&&""===t[t.length-1].str;)t.pop();if(!r){e.next=23;break}return e.next=23,this.send(g.keymap.Home);case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLines",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContent();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return e.str})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(e){var t=this;return this.config.preventIdleTimeout&&this.preventIdle(this.config.preventIdleTimeout),new Promise((function(r,n){var a,i=function(e){clearTimeout(a),r(!0)};t.state.connect?e.length>0?(t.socket.send((0,g.encode)(e,t.currentCharset)),t.once("message",i),a=setTimeout((function(){t.removeListener("message",i),r(!1)}),10*t.config.timeout)):(console.info("Sending message with 0-length. Skipped."),r(!0)):n()}))}},{key:"preventIdle",value:function(e){var t=this;clearTimeout(this.preventIdleHandler),this.state.login&&(this.preventIdleHandler=setTimeout((0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.send(g.keymap.CtrlU);case 2:return e.next=4,t.send(g.keymap.ArrowLeft);case 4:case"end":return e.stop()}}),e)}))),1e3*e))}},{key:"login",value:function(){var e=(0,o.default)(s.default.mark((function e(t,r){var n,a,i,o=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(o.length>2&&void 0!==o[2])||o[2],!this.state.login){e.next=3;break}return e.abrupt("return");case 3:return t=t.replace(/,/g,""),"utf8"===this.config.charset&&(t+=","),e.next=7,this.send("".concat(t).concat(g.keymap.Enter).concat(r).concat(g.keymap.Enter));case 7:return e.next=9,this.checkLogin(n);case 9:return(a=e.sent)&&((i=this._state).login=!0,i.position={boardname:""},this._state.username=t.substring(0,t.length-1),this.emit("stateChange",this.state)),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.login){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.send("G".concat(g.keymap.Enter,"Y").concat(g.keymap.Enter));case 4:return this._state.login=!1,this.emit("stateChange",this.state),this.send(g.keymap.Enter),e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkLogin",value:function(){var e=(0,o.default)(s.default.mark((function e(t){var r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.line[21].str.includes("\u5bc6\u78bc\u4e0d\u5c0d\u6216\u7121\u6b64\u5e33\u865f")&&!this.line[21].str.includes("\u8acb\u91cd\u65b0\u8f38\u5165")){e.next=5;break}return this.emit("login.failed"),e.abrupt("return",!1);case 5:if(!this.line[23].str.includes("\u8acb\u7a0d\u5f8c\u518d\u8a66")){e.next=10;break}return this.emit("login.failed"),e.abrupt("return",!1);case 10:if(!this.line[13].str.includes("\u4e82\u8e39\u5bc6\u78bc\u6703\u7559\u4e0b\u8a18\u9304\u5594")){e.next=15;break}return this.emit("login.failed"),e.abrupt("return",!1);case 15:r=0;case 16:return e.next=19,(0,b.default)(400);case 19:if(!(n=this.line)[22].str.includes("\u767b\u5165\u4e2d\uff0c\u8acb\u7a0d\u5019...")){e.next=23;break}e.next=64;break;case 23:if(!n[22].str.includes("\u60a8\u60f3\u522a\u9664\u5176\u4ed6\u91cd\u8907\u767b\u5165\u7684\u9023\u7dda\u55ce")){e.next=32;break}if(1!==r){e.next=26;break}return e.abrupt("continue",16);case 26:return e.next=28,this.send("".concat(t?"y":"n").concat(g.keymap.Enter));case 28:return r=1,e.abrupt("continue",16);case 32:if(!n[23].str.includes("\u8acb\u52ff\u983b\u7e41\u767b\u5165\u4ee5\u514d\u9020\u6210\u7cfb\u7d71\u904e\u5ea6\u8ca0\u8377")){e.next=40;break}if(2!==r){e.next=35;break}return e.abrupt("continue",16);case 35:return e.next=37,this.send("".concat(g.keymap.Enter));case 37:r=2,e.next=64;break;case 40:if(!n[23].str.includes("\u60a8\u8981\u522a\u9664\u4ee5\u4e0a\u932f\u8aa4\u5617\u8a66\u7684\u8a18\u9304\u55ce")){e.next=48;break}if(3!==r){e.next=43;break}return e.abrupt("continue",16);case 43:return e.next=45,this.send("y".concat(g.keymap.Enter));case 45:r=3,e.next=64;break;case 48:if(!n[23].str.includes("\u6309\u4efb\u610f\u9375\u7e7c\u7e8c")){e.next=53;break}return e.next=51,this.send("".concat(g.keymap.Enter));case 51:e.next=64;break;case 53:if(!(n[22].str+n[23].str).toLowerCase().includes("y/n")){e.next=59;break}return console.info("Unknown login state: \n".concat(this.screen)),e.next=57,this.send("y".concat(g.keymap.Enter));case 57:e.next=64;break;case 59:if(!n[23].str.includes("\u6211\u662f")){e.next=63;break}return e.abrupt("break",66);case 63:console.info("Unknown login state: \n".concat(this.screen));case 64:e.next=16;break;case 66:return this.emit("login.success"),e.abrupt("return",!0);case 68:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkArticleWithHeader",value:function(){return"\u4f5c\u8005"===(0,x.substrWidth)("dbcs",this.line[0].str,0,6).trim()}},{key:"select",value:function(e){return e.select(this)}},{key:"getMails",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,r,n,a,i,o,c=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,e.next=3,this.enterMail();case 3:if(!(t>0)){e.next=7;break}return t=Math.max(t-9,1),e.next=7,this.send("".concat(g.keymap.End).concat(g.keymap.End).concat(t).concat(g.keymap.Enter));case 7:for(r=this.getLine,n=[],a=3;a<=22;a++)i=r(a).str,o={sn:+(0,x.substrWidth)("dbcs",i,1,5).trim(),date:(0,x.substrWidth)("dbcs",i,9,5).trim(),author:(0,x.substrWidth)("dbcs",i,15,12).trim(),status:(0,x.substrWidth)("dbcs",i,30,2).trim(),title:(0,x.substrWidth)("dbcs",i,33).trim()},n.push(o);return e.next=12,this.enterIndex();case 12:return e.abrupt("return",n.reverse());case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMail",value:function(){var e=(0,o.default)(s.default.mark((function e(t){var r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enterMail();case 2:return r=this.getLine,e.next=5,this.send("".concat(t).concat(g.keymap.Enter).concat(g.keymap.Enter));case 5:return this.checkArticleWithHeader(),n={sn:t,author:"",title:"",timestamp:"",lines:[]},this.checkArticleWithHeader()&&(n.author=(0,x.substrWidth)("dbcs",r(0).str,7,50).trim(),n.title=(0,x.substrWidth)("dbcs",r(1).str,7).trim(),n.timestamp=(0,x.substrWidth)("dbcs",r(2).str,7).trim()),e.next=10,this.getLines();case 10:return n.lines=e.sent,e.next=13,this.enterIndex();case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"enterIndex",value:function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send("".concat(g.keymap.ArrowLeft.repeat(10)));case 2:return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"goToTop",value:function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send("".concat(g.keymap.Home));case 2:return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enterArticleByAIDFromBoard",value:function(){var e=(0,o.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.login){e.next=2;break}return e.abrupt("return",Promise.reject("not login"));case 2:return r="#".concat(t).concat(g.keymap.Enter),e.next=5,this.send(r);case 5:if(e.sent){e.next=10;break}return e.next=9,this.send("".concat(g.keymap.Enter));case 9:return e.abrupt("return",Promise.reject("enterArticleByAIDFromBoard failed"));case 10:return e.next=12,this.send("".concat(g.keymap.ArrowRight));case 12:return e.abrupt("return",Promise.resolve("now in article : ".concat(t)));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"enterArticleByAID",value:function(){var e=(0,o.default)(s.default.mark((function e(t,r){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.login){e.next=2;break}return e.abrupt("return",Promise.reject("not login"));case 2:return e.prev=2,e.next=5,this.enterBoardByName(t);case 5:return e.next=7,this.enterArticleByAIDFromBoard(r);case 7:return e.abrupt("return",Promise.resolve("now in article : ".concat(r)));case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"sendCommentSearchMode",value:function(){var e=(0,o.default)(s.default.mark((function e(t){var r,n,a,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(r=(r=t.text).trim()).length){e.next=4;break}return e.abrupt("return",Promise.reject("empty string"));case 4:52,r=function(e){for(var t=[],r="",n=0,a=0;n<e.length;)e[n]>="\xff"?a>=51?(t.push(r),r="",a=0):(r+=e[n],a+=2,n++):52==a?(t.push(r),r="",a=0):(r+=e[n],a+=1,n++);return t.push(r),t}(r),e.prev=7,n=E(r),e.prev=9,n.s();case 11:if((a=n.n()).done){e.next=29;break}return i=a.value,e.next=15,this.send("X");case 15:if(!this.line[23].str.includes("\u60a8\u89ba\u5f97\u9019\u7bc7\u6587\u7ae0")){e.next=18;break}return e.next=18,this.send("".concat(t.type));case 18:if(!this.line[22].str.includes("\u4f7f\u7528 \u2192 \u52a0\u8a3b\u65b9\u5f0f")&&!this.line[23].str.includes(this.state.username)){e.next=25;break}return e.next=21,this.send("".concat(i).concat(g.keymap.Enter));case 21:return e.next=23,this.send("y".concat(g.keymap.Enter));case 23:e.next=27;break;case 25:return e.next=27,this.send("".concat(g.keymap.ArrowLeft));case 27:e.next=11;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(9),n.e(e.t0);case 34:return e.prev=34,n.f(),e.finish(34);case 37:return e.abrupt("return",Promise.resolve("comment success"));case 40:return e.prev=40,e.t1=e.catch(7),e.abrupt("return",Promise.reject(e.t1));case 43:case"end":return e.stop()}}),e,this,[[7,40],[9,31,34,37]])})));return function(t){return e.apply(this,arguments)}}()},{key:"enterArticle",value:function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendComment",value:function(){var e=(0,o.default)(s.default.mark((function e(t){var r,n,a,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.login){e.next=2;break}return e.abrupt("return",Promise.reject("not login"));case 2:if(0!==(r=(r=t.text).trim()).length){e.next=6;break}return e.abrupt("return",Promise.reject("empty string"));case 6:return 52,r=function(e){for(var t=[],r="",n=0,a=0;n<e.length;)e[n]>="\xff"?a>=51?(t.push(r),r="",a=0):(r+=e[n],a+=2,n++):52==a?(t.push(r),r="",a=0):(r+=e[n],a+=1,n++);return t.push(r),t}(r),e.prev=9,e.next=12,this.enterBoardByName(t.boardName);case 12:n=E(r),e.prev=13,n.s();case 15:if((a=n.n()).done){e.next=31;break}return i=a.value,e.next=19,this.enterArticle();case 19:return e.next=21,this.send("X");case 21:if(!this.line[23].str.includes("\u60a8\u89ba\u5f97\u9019\u7bc7\u6587\u7ae0")){e.next=24;break}return e.next=24,this.send("".concat(t.type));case 24:if(!this.line[22].str.includes("\u4f7f\u7528 \u2192 \u52a0\u8a3b\u65b9\u5f0f")&&!this.line[23].str.includes(this.state.username)){e.next=29;break}return e.next=27,this.send("".concat(i).concat(g.keymap.Enter));case 27:return e.next=29,this.send("y".concat(g.keymap.Enter));case 29:e.next=15;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(13),n.e(e.t0);case 36:return e.prev=36,n.f(),e.finish(36);case 39:return e.next=41,this.enterIndex();case 41:return e.abrupt("return",Promise.resolve("comment success"));case 44:return e.prev=44,e.t1=e.catch(9),e.abrupt("return",Promise.reject(e.t1));case 47:case"end":return e.stop()}}),e,this,[[9,44],[13,33,36,39]])})));return function(t){return e.apply(this,arguments)}}()},{key:"enterBoardByName",value:function(){var e=(0,o.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send("s".concat(t).concat(g.keymap.Enter," ").concat(g.keymap.Home).concat(g.keymap.End));case 2:if(this.currentBoardname.toLowerCase()!==t.toLowerCase()){e.next=8;break}return this._state.position.boardname=this.currentBoardname,this.emit("stateChange",this.state),e.abrupt("return",Promise.resolve("now in board : ".concat(t)));case 8:return e.next=10,this.enterIndex();case 10:return e.abrupt("return",Promise.reject("enterBoardByName failed"));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"enterByOffset",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,r,n=this,a=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:[],r=!0,t.forEach(function(){var e=(0,o.default)(s.default.mark((function e(t){var a,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t&&(r=!1),!(t<0)){e.next=15;break}a=22;case 3:if(!(a>=3)){e.next=15;break}if(!((i=(0,x.substrWidth)("dbcs",n.line[a].str,3,4).trim()).length>0)){e.next=8;break}return t+=+i+1,e.abrupt("break",15);case 8:if(!((i=(0,x.substrWidth)("dbcs",n.line[a].str,15,2).trim()).length>0)){e.next=12;break}return t+=+i+1,e.abrupt("break",15);case 12:a--,e.next=3;break;case 15:if(t<0&&(r=!1),r){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,n.send("".concat(t).concat(g.keymap.Enter.repeat(2)," ").concat(g.keymap.Home).concat(g.keymap.End));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!r){e.next=11;break}return this._state.position.boardname=this.currentBoardname,this.emit("stateChange",this.state),e.next=8,this.send(g.keymap.Home);case 8:return e.abrupt("return",!0);case 11:return e.next=13,this.enterIndex();case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enterBoardByOffset",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,r=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],e.next=3,this.send("C".concat(g.keymap.Enter));case 3:return e.next=5,this.enterByOffset(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enterFavorite",value:function(){var e=(0,o.default)(s.default.mark((function e(){var t,r=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],e.next=3,this.send("F".concat(g.keymap.Enter));case 3:return e.next=5,this.enterByOffset(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enterMail",value:function(){var e=(0,o.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send("M".concat(g.keymap.Enter,"R").concat(g.keymap.Enter).concat(g.keymap.Home).concat(g.keymap.End));case 2:return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"state",get:function(){return j({},this._state)}},{key:"currentBoardname",get:function(){var e=w(/\u3010(?!\u770B\u677F\u5217\u8868).*\u3011.*\u300A(.*)\u300B/,{boardname:1}).exec(this.line[0].str);return e?e.groups.boardname:void 0}}]),r}(m.default);(0,p.default)(B,"initialState",{connect:!1,login:!1}),(0,p.default)(B,"forwardEvents",["message","error"]);var T=B;t.default=T},203:function(e,t){},205:function(e,t){},231:function(e,t,r){"use strict";(function(e){var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(113)),i=r(137),s=function(t,r){var n="";switch(r){case"utf8":case"utf-8":n=e.from(t).toString("utf8");break;case"big5":n=(0,i.decodeSync)(String.fromCharCode.apply(String,(0,a.default)(t)));break;default:throw new TypeError("Unknown charset: ".concat(r))}return n};t.default=s}).call(this,r(54).Buffer)},232:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(137),a=function(t,r){var a;switch(r){case"utf8":case"utf-8":a=e.from(t,"utf8");break;case"big5":a=e.from((0,n.encodeSync)(t),"binary");break;default:throw new TypeError("Unknown charset: ".concat(r))}return a};t.default=a}).call(this,r(54).Buffer)},233:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Enter:"\r",ArrowLeft:"\x1b[D",ArrowRight:"\x1b[C",ArrowUp:"\x1b[A",ArrowDown:"\x1b[B",PgUp:"\x1b[5~",PgDown:"\x1b[6~",Home:"\x1b[1~",End:"\x1b[4~",Backspace:"\b",CtrlC:"\x03",CtrlP:"\x10",CtrlU:"\x15",CtrlZ:"\x1a"}},234:function(e,t,r){},239:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ArticleSelectQueryBuilder=t.WhereType=t.Article=void 0;var a=n(r(85)),i=n(r(86)),s=n(r(51)),o=n(r(52)),c=n(r(53)),u=n(r(40)),l=n(r(41)),f=n(r(71)),d=n(r(72)),h=r(114),p=r(89),m=r(90);function b(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var g,x=function(){function e(){(0,l.default)(this,e),(0,d.default)(this,"boardname",void 0),(0,d.default)(this,"id",void 0),(0,d.default)(this,"push",void 0),(0,d.default)(this,"date",void 0),(0,d.default)(this,"timestamp",void 0),(0,d.default)(this,"author",void 0),(0,d.default)(this,"status",void 0),(0,d.default)(this,"title",void 0),(0,d.default)(this,"fixed",void 0),(0,d.default)(this,"iterator",void 0),(0,d.default)(this,"sendComment",void 0),(0,d.default)(this,"_content",[])}return(0,f.default)(e,[{key:"content",get:function(){return this._content},set:function(e){this._content=e.slice()}},{key:"data",get:function(){return this._content.map((function(e){return e.str}))},set:function(e){console.warn("Should not set Mail.data/Mail.lines directly. Use Mail.content instead")}}]),(0,f.default)(e,[{key:"hasHeader",value:function(){return 0!==this.content.length&&"\u4f5c\u8005"===(0,m.substrWidth)("dbcs",this.content[0].str,0,6).trim()}}],[{key:"fromLine",value:function(t){var r=new e,n=t.str;return r.id=+(0,m.substrWidth)("dbcs",n,1,7).trim(),r.push=(0,m.substrWidth)("dbcs",n,9,2).trim(),r.date=(0,m.substrWidth)("dbcs",n,11,5).trim(),r.author=(0,m.substrWidth)("dbcs",n,17,12).trim(),r.status=(0,m.substrWidth)("dbcs",n,30,2).trim(),r.title=(0,m.substrWidth)("dbcs",n,32).trim(),r.fixed=(0,m.substrWidth)("dbcs",n,1,7).trim().includes("\u2605"),r}},{key:"select",value:function(e){return new k(e)}}]),e}();t.Article=x,t.WhereType=g,function(e){e.Boardname="boardname",e.Id="id",e.Push="push",e.Author="author",e.Title="title"}(g||(t.WhereType=g={}));var k=function(e){(0,o.default)(r,e);var t=y(r);function r(e){var n;return(0,l.default)(this,r),n=t.call(this),(0,d.default)((0,s.default)(n),"bot",void 0),(0,d.default)((0,s.default)(n),"boardname",""),(0,d.default)((0,s.default)(n),"wheres",[]),(0,d.default)((0,s.default)(n),"id",0),n.bot=e,n}return(0,f.default)(r,[{key:"where",value:function(e,t){switch(e){case g.Boardname:""!==this.boardname?console.warn('Cannot call where with type "'.concat(e,'" multiple times')):this.boardname=t;break;case g.Id:this.id=+t;break;case g.Push:this.wheres.push({type:"Z",condition:t});break;case g.Author:this.wheres.push({type:"a",condition:t});break;case g.Title:this.wheres.push({type:"/",condition:t});break;default:throw new Error("Invalid type: ".concat(e))}return this}},{key:"getQuery",value:function(){return this.wheres.map((function(e){var t=e.type,r=e.condition;return"".concat(t).concat(r).concat(p.keymap.Enter)})).join()}},{key:"getIterator",value:function(){var e,t=this;return{next:function(){var r=(0,i.default)(a.default.mark((function r(){var n,i,s,o,c;return a.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,1!==e){r.next=3;break}return r.abrupt("return",{value:null,done:!0});case 3:if(e){r.next=16;break}return r.next=6,t.bot.enterBoardByName(t.boardname);case 6:return r.next=8,t.bot.send(t.getQuery());case 8:if(n=r.sent,console.log("found",n),n){r.next=12;break}return r.abrupt("return",{value:null,done:!0});case 12:return r.next=14,t.bot.send("".concat(p.keymap.End));case 14:r.next=18;break;case 16:return r.next=18,t.bot.send("".concat(p.keymap.PgUp));case 18:i=[],s=3;case 20:if(!(s<=22)){r.next=30;break}if(""!==(o=t.bot.line[s]).str.trim()){r.next=24;break}return r.abrupt("break",30);case 24:(c=x.fromLine(o)).boardname=t.boardname,i.push(c);case 27:s++,r.next=20;break;case 30:return e=i[0].id,r.abrupt("return",{value:i,done:!1});case 34:return r.prev=34,r.t0=r.catch(0),r.abrupt("return",Promise.reject(r.t0));case 37:case"end":return r.stop()}}),r,null,[[0,34]])})));return function(){return r.apply(this,arguments)}}()}}},{key:"getOneInSearch",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.send("".concat(this.id).concat(p.keymap.Enter).concat(p.keymap.Enter));case 2:return(t=new x).id=this.id,t.boardname=this.boardname,e.next=7,this.bot.getContent();case 7:return t.content=e.sent,t.hasHeader()&&(t.author=(0,m.substrWidth)("dbcs",this.bot.line[0].str,7,50).trim(),t.title=(0,m.substrWidth)("dbcs",this.bot.line[1].str,7).trim(),t.timestamp=(0,m.substrWidth)("dbcs",this.bot.line[2].str,7).trim()),e.next=11,this.bot.send("".concat(p.keymap.ArrowLeft));case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t,r,n,i,s,o,c;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.enterBoardByName(this.boardname);case 2:return e.next=4,this.bot.send(this.getQuery());case 4:if(e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(!(this.id>0)){e.next=11;break}return t=Math.max(this.id-9,1),e.next=11,this.bot.send("".concat(p.keymap.End).concat(p.keymap.End).concat(t).concat(p.keymap.Enter));case 11:r=[],n=3;case 13:if(!(n<=22)){e.next=23;break}if(""!==(i=this.bot.line[n]).str.trim()){e.next=17;break}return e.abrupt("break",23);case 17:(s=x.fromLine(i)).boardname=this.boardname,r.push(s);case 20:n++,e.next=13;break;case 23:if(!(r.length>=2&&0===r[0].id)){e.next=32;break}o=1;case 25:if(!(o<r.length)){e.next=32;break}if(0===r[o].id){e.next=29;break}return r[0].id=r[o].id-o,e.abrupt("break",32);case 29:o++,e.next=25;break;case 32:for(c=1;c<r.length;c++)r[c].id=r[c-1].id+1;return e.next=35,this.bot.enterIndex();case 35:return e.abrupt("return",r.reverse());case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOne",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.enterBoardByName(this.boardname);case 2:return e.next=4,this.bot.send(this.getQuery());case 4:if(e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.next=9,this.bot.send("".concat(this.id).concat(p.keymap.Enter).concat(p.keymap.Enter));case 9:return(t=new x).id=this.id,t.boardname=this.boardname,e.next=14,this.bot.getContent();case 14:return t.content=e.sent,t.hasHeader()&&(t.author=(0,m.substrWidth)("dbcs",this.bot.line[0].str,7,50).trim(),t.title=(0,m.substrWidth)("dbcs",this.bot.line[1].str,7).trim(),t.timestamp=(0,m.substrWidth)("dbcs",this.bot.line[2].str,7).trim()),e.next=18,this.bot.enterIndex();case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOneIterator",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.enterBoardByName(this.boardname);case 2:return e.next=4,this.bot.send(this.getQuery());case 4:if(e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.prev=7,e.next=10,this.bot.send("".concat(this.id).concat(p.keymap.Enter).concat(p.keymap.Enter));case 10:return(t=new x).id=this.id,t.boardname=this.boardname,e.next=15,this.bot.getContentIterator();case 15:return t.iterator=e.sent,t.sendComment=this.sendComment,e.abrupt("return",t);case 20:return e.prev=20,e.t0=e.catch(7),e.abrupt("return",Promise.reject(e.t0));case 23:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendComment",value:function(){var e=(0,i.default)(a.default.mark((function e(t,r){var n,i,s,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.state.login){e.next=2;break}return e.abrupt("return",Promise.reject("not login"));case 2:if(0!==(n=(n=t.text).trim()).length){e.next=6;break}return e.abrupt("return",Promise.reject("empty string"));case 6:52,n=function(e){for(var t=[],r="",n=0,a=0;n<e.length;)e[n]>="\xff"?a>=51?(t.push(r),r="",a=0):(r+=e[n],a+=2,n++):52==a?(t.push(r),r="",a=0):(r+=e[n],a+=1,n++);return t.push(r),t}(n),e.prev=9,i=b(n),e.prev=11,i.s();case 13:if((s=i.n()).done){e.next=35;break}return o=s.value,e.next=17,r.send("X");case 17:if(console.log("after pressing X",r.screen),!r.line[23].str.includes("\u60a8\u89ba\u5f97\u9019\u7bc7\u6587\u7ae0")){e.next=21;break}return e.next=21,r.send("".concat(t.type));case 21:if(!r.line[22].str.includes("\u4f7f\u7528 \u2192 \u52a0\u8a3b\u65b9\u5f0f")&&!r.line[23].str.includes(r.state.username)){e.next=29;break}return e.next=24,r.send("".concat(o).concat(p.keymap.Enter));case 24:return e.next=26,r.send("y".concat(p.keymap.Enter));case 26:console.log("after send ",r.screen),e.next=30;break;case 29:return e.abrupt("return",Promise.reject("comment failed"));case 30:return e.next=32,r.send("".concat(p.keymap.Enter));case 32:console.log("after enter ",r.screen);case 33:e.next=13;break;case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(11),i.e(e.t0);case 40:return e.prev=40,i.f(),e.finish(40);case 43:return e.abrupt("return",Promise.resolve("comment success"));case 46:return e.prev=46,e.t1=e.catch(9),e.abrupt("return",Promise.reject(e.t1));case 49:case"end":return e.stop()}}),e,null,[[9,46],[11,37,40,43]])})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(h.SelectQueryBuilder);t.ArticleSelectQueryBuilder=k;var w=x;t.default=w},240:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.QueryBuilder=void 0;var a=n(r(41));t.QueryBuilder=function e(){(0,a.default)(this,e)}},241:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BoardSelectQueryBuilder=t.Entry=t.WhereType=t.Board=void 0;var a=n(r(85)),i=n(r(113)),s=n(r(86)),o=n(r(51)),c=n(r(52)),u=n(r(53)),l=n(r(40)),f=n(r(41)),d=n(r(71)),h=n(r(72)),p=r(114),m=r(89),b=r(90);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var y,g,x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,f.default)(this,e),(0,h.default)(this,"name",""),(0,h.default)(this,"id",0),(0,h.default)(this,"unread",!1),(0,h.default)(this,"category",""),(0,h.default)(this,"flag",""),(0,h.default)(this,"title",""),(0,h.default)(this,"users",""),(0,h.default)(this,"admin",""),(0,h.default)(this,"folder",!1),(0,h.default)(this,"divider",!1),this.name=t}return(0,d.default)(e,null,[{key:"fromLine",value:function(t){var r=new e,n=t.str;switch(r.id=+(0,b.substrWidth)("dbcs",n,3,4).trim(),r.unread="\u02c7"===(0,b.substrWidth)("dbcs",n,8,2).trim(),r.name=(0,b.substrWidth)("dbcs",n,10,12).trim(),r.category=(0,b.substrWidth)("dbcs",n,23,4).trim(),r.flag=(0,b.substrWidth)("dbcs",n,28,2).trim(),r.flag){case"\u25a1":r.title=(0,b.substrWidth)("dbcs",n,30).replace(/\s+$/,""),r.folder=!0;break;case"--":r.divider=!0;break;case"\u03a3":r.title=(0,b.substrWidth)("dbcs",n,30,31).replace(/\s+$/,""),r.users=(0,b.substrWidth)("dbcs",n,62,5).trim(),r.admin=(0,b.substrWidth)("dbcs",n,67).trim(),r.folder=!0;break;case"\u25ce":r.title=(0,b.substrWidth)("dbcs",n,30,31).replace(/\s+$/,""),r.users=(0,b.substrWidth)("dbcs",n,62,5).trim(),r.admin=(0,b.substrWidth)("dbcs",n,67).trim();break;default:console.warn('Unknown board flag. line.str: "'.concat(n,'"'))}return r}},{key:"fromClassLine",value:function(t){var r=new e,n=t.str;return r.id=+(0,b.substrWidth)("dbcs",n,15,2),r.title=(0,b.substrWidth)("dbcs",n,20,29).replace(/\s+$/,""),r.admin=(0,b.substrWidth)("dbcs",n,61).trim(),r.folder=!0,r}},{key:"select",value:function(e){return new k(e)}}]),e}();t.Board=x,t.WhereType=y,function(e){e.Entry="entry",e.Prefix="prefix",e.Offset="offset",e.Offsets="offsets"}(y||(t.WhereType=y={})),t.Entry=g,function(e){e.Class="class",e.Favorite="favorite",e.Hot="hot"}(g||(t.Entry=g={}));var k=function(e){(0,c.default)(r,e);var t=v(r);function r(e){var n;return(0,f.default)(this,r),n=t.call(this),(0,h.default)((0,o.default)(n),"bot",void 0),(0,h.default)((0,o.default)(n),"entry",g.Class),(0,h.default)((0,o.default)(n),"prefix",""),(0,h.default)((0,o.default)(n),"offsets",[]),n.bot=e,n}return(0,d.default)(r,[{key:"where",value:function(e,t){switch(e.toLowerCase()){case y.Entry:this.entry=t.toLowerCase();break;case y.Prefix:this.prefix=t;break;case y.Offset:this.offsets.push(t);break;case y.Offsets:this.offsets=t.slice();break;default:throw new Error("Invalid type: ".concat(e))}return this}},{key:"get",value:function(){var e=(0,s.default)(a.default.mark((function e(){var t,r,n,s,o,c,u,l,f;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===this.prefix){e.next=4;break}return e.next=3,this.getByPrefix(this.prefix);case 3:return e.abrupt("return",e.sent);case 4:e.t0=this.entry,e.next=e.t0===g.Class?7:e.t0===g.Favorite?11:e.t0===g.Hot?15:19;break;case 7:return e.next=9,this.bot.enterBoardByOffset(this.offsets);case 9:return t=e.sent,e.abrupt("break",19);case 11:return e.next=13,this.bot.enterFavorite(this.offsets);case 13:return t=e.sent,e.abrupt("break",19);case 15:return e.next=17,this.bot.enterBoardByOffset([-1].concat((0,i.default)(this.offsets)));case 17:return t=e.sent,e.abrupt("break",19);case 19:if(r=[],!t){e.next=56;break}if(this.entry!==g.Class||0!==this.offsets.length){e.next=34;break}n=7;case 23:if(!(n<23)){e.next=32;break}if(""!==(s=this.bot.line[n]).str.trim()){e.next=27;break}return e.abrupt("break",32);case 27:o=x.fromClassLine(s),r.push(o);case 29:n++,e.next=23;break;case 32:e.next=56;break;case 34:0,c=!1,u=3;case 37:if(!(u<23)){e.next=50;break}if(""!==(l=this.bot.line[u]).str.trim()){e.next=42;break}return c=!0,e.abrupt("break",50);case 42:if((f=x.fromLine(l)).id===r.length+1){e.next=46;break}return c=!0,e.abrupt("break",50);case 46:r.push(f);case 47:u++,e.next=37;break;case 50:if(!c){e.next=52;break}return e.abrupt("break",56);case 52:return e.next=54,this.bot.send(m.keymap.PgDown);case 54:e.next=34;break;case 56:return e.next=58,this.bot.enterIndex();case 58:return e.abrupt("return",r);case 59:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOne",value:function(){var e=(0,s.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return t=e.sent,e.abrupt("return",t.length?t[0]:void 0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getByPrefix",value:function(){var e=(0,s.default)(a.default.mark((function e(t){var r,n,i,s,o,c,u,l,f;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.send("s".concat(t," "));case 2:if(r=[],0!==(n=this.bot.line[3].str).toLowerCase().indexOf(t.toLowerCase())){e.next=27;break}for(i=0,s=0,o=15;o<n.length&&" "!==n[o];)o+=1;for(;o<n.length&&" "===n[o];)o+=1;case 9:if(c=this.bot.line[s+3],""===(u=(0,b.substrWidth)("dbcs",c.str,i*o,o).trim())){e.next=16;break}r.push(new x(u)),e.next=17;break;case 16:return e.abrupt("break",25);case 17:if(20!=(s+=1)){e.next=23;break}if(s=0,!(((i+=1)+1)*o>80)){e.next=23;break}return e.abrupt("break",25);case 23:e.next=9;break;case 25:e.next=30;break;case 27:l=this.bot.line[1].str,0===(f=(0,b.substrWidth)("dbcs",l,34,15).trim()).toLowerCase().indexOf(t.toLowerCase())&&r.push(new x(f));case 30:return e.next=32,this.bot.send(m.keymap.CtrlC);case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(p.SelectQueryBuilder);t.BoardSelectQueryBuilder=k;var w=x;t.default=w},242:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MailSelectQueryBuilder=t.WhereType=t.Mail=void 0;var a=n(r(85)),i=n(r(86)),s=n(r(51)),o=n(r(52)),c=n(r(53)),u=n(r(40)),l=n(r(41)),f=n(r(71)),d=n(r(72)),h=r(114),p=r(89),m=r(90);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var v,y=function(){function e(){(0,l.default)(this,e),(0,d.default)(this,"id",void 0),(0,d.default)(this,"date",void 0),(0,d.default)(this,"timestamp",void 0),(0,d.default)(this,"author",void 0),(0,d.default)(this,"status",void 0),(0,d.default)(this,"title",void 0),(0,d.default)(this,"_content",[])}return(0,f.default)(e,[{key:"content",get:function(){return this._content},set:function(e){this._content=e.slice()}},{key:"data",get:function(){return this._content.map((function(e){return e.str}))},set:function(e){console.warn("Should not set Mail.data/Mail.lines directly. Use Mail.content instead")}}]),(0,f.default)(e,[{key:"hasHeader",value:function(){return 0!==this.content.length&&"\u4f5c\u8005"===(0,m.substrWidth)("dbcs",this.content[0].str,0,6).trim()}}],[{key:"fromLine",value:function(t){var r=new e,n=t.str;return r.id=+(0,m.substrWidth)("dbcs",n,1,5).trim(),r.date=(0,m.substrWidth)("dbcs",n,9,5).trim(),r.author=(0,m.substrWidth)("dbcs",n,15,12).trim(),r.status=(0,m.substrWidth)("dbcs",n,30,2).trim(),r.title=(0,m.substrWidth)("dbcs",n,33).trim(),r}},{key:"select",value:function(e){return new g(e)}}]),e}();t.Mail=y,t.WhereType=v,function(e){e.Id="id",e.Author="author",e.Title="title"}(v||(t.WhereType=v={}));var g=function(e){(0,o.default)(r,e);var t=b(r);function r(e){var n;return(0,l.default)(this,r),n=t.call(this),(0,d.default)((0,s.default)(n),"bot",void 0),(0,d.default)((0,s.default)(n),"wheres",[]),(0,d.default)((0,s.default)(n),"id",0),n.bot=e,n}return(0,f.default)(r,[{key:"where",value:function(e,t){switch(e){case v.Id:this.id=+t;break;case v.Author:this.wheres.push({type:"a",condition:t});break;case v.Title:this.wheres.push({type:"/",condition:t});break;default:throw new Error("Invalid type: ".concat(e))}return this}},{key:"getQuery",value:function(){return this.wheres.map((function(e){var t=e.type,r=e.condition;return"".concat(t).concat(r).concat(p.keymap.Enter)})).join()}},{key:"get",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t,r,n,i,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.enterMail();case 2:return e.next=4,this.bot.send(this.getQuery());case 4:if(e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(!(this.id>0)){e.next=11;break}return t=Math.max(this.id-9,1),e.next=11,this.bot.send("".concat(p.keymap.End).concat(p.keymap.End).concat(t).concat(p.keymap.Enter));case 11:r=[],n=3;case 13:if(!(n<=22)){e.next=22;break}if(""!==(i=this.bot.line[n]).str.trim()){e.next=17;break}return e.abrupt("break",22);case 17:s=y.fromLine(i),r.push(s);case 19:n++,e.next=13;break;case 22:return e.next=24,this.bot.enterIndex();case 24:return e.abrupt("return",r.reverse());case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOne",value:function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bot.enterMail();case 2:return e.next=4,this.bot.send(this.getQuery());case 4:if(e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.next=9,this.bot.send("".concat(this.id).concat(p.keymap.Enter).concat(p.keymap.Enter));case 9:return(t=new y).id=this.id,e.next=13,this.bot.getContent();case 13:return t.content=e.sent,t.hasHeader()&&(t.author=(0,m.substrWidth)("dbcs",this.bot.line[0].str,7,50).trim(),t.title=(0,m.substrWidth)("dbcs",this.bot.line[1].str,7).trim(),t.timestamp=(0,m.substrWidth)("dbcs",this.bot.line[2].str,7).trim()),e.next=17,this.bot.enterIndex();case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(h.SelectQueryBuilder);t.MailSelectQueryBuilder=g;var x=y;t.default=x},265:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(14),s=r.n(i),o=(r(184),r(147)),c=r(148),u=r(161),l=r(162),f=r(300),d=r(303),h=r(7),p=r(5),m=r.n(p),b=r(9),v=r(308),y=r(307),g=r(332),x=r(314),k=r(330),w=r(305),E=r(79),O=r(331),S=r(100),j=r(36),C=new S.a,B=Object(j.a)((function(){var e=Object(n.useState)(C.get("user")),t=Object(h.a)(e,2);return{user:t[0],setUser:t[1]}})),T=Object(h.a)(B,2),L=T[0],P=T[1],N=r(59),_=r(149),W=r.n(_);var I=Object(j.a)((function(){var e=Object(n.useState)(!1),t=Object(h.a)(e,2),r=t[0],a=t[1],i=Object(n.useState)({severity:"",text:""}),s=Object(h.a)(i,2);return{isSnackbarOpen:r,setIsSnackbarOpen:a,snackbarContent:s[0],setSnackbarContent:s[1]}})),A=Object(h.a)(I,2),M=A[0],R=A[1],D=Object(j.a)((function(){console.info("new useBot()");var e=Object(n.useState)(new W.a),t=Object(h.a)(e,1)[0],r=Object(n.useState)(t.state),a=Object(h.a)(r,2),i=a[0],s=a[1],o=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}(i);t.on("connect",(function(){s(t.state)})),t.on("disconnect",(function(){s(t.state)}));var c=!1,u=function(){var e=Object(b.a)(m.a.mark((function e(r){var n,a,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.username,a=r.password,e.next=3,t.login(n,a,!0);case 3:return(o=e.sent)&&s(Object(N.a)({},i,{login:!0})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(b.a)(m.a.mark((function e(r){var n,a,s,o,l,f,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=2;break}return e.abrupt("return",Promise.reject("bot is busy!"));case 2:if(c=!0,e.prev=3,i.connect){e.next=6;break}return e.abrupt("return",Promise.reject("not login!"));case 6:if("index"!==r.type){e.next=11;break}return e.next=9,t.enterIndex();case 9:return c=!1,e.abrupt("return",!0);case 11:if("top"!==r.type){e.next=16;break}return e.next=14,t.goToTop();case 14:return c=!1,e.abrupt("return",!0);case 16:if("login"!==r.type){e.next=24;break}if(!i.login){e.next=19;break}return e.abrupt("return",!0);case 19:return e.next=21,u(r.arg);case 21:return n=e.sent,c=!1,e.abrupt("return",n);case 24:if("select"!==r.type){e.next=33;break}if(i.login){e.next=27;break}return e.abrupt("return",!1);case 27:return a=r.arg,e.next=30,a.get();case 30:return s=e.sent,c=!1,e.abrupt("return",s);case 33:if("content"!==r.type){e.next=42;break}if(i.login){e.next=36;break}return e.abrupt("return",!1);case 36:return o=r.arg,e.next=39,o.getOne();case 39:return l=e.sent,c=!1,e.abrupt("return",l);case 42:if("contentIterator"!==r.type){e.next=51;break}if(i.login){e.next=45;break}return e.abrupt("return",!1);case 45:return f=r.arg,e.next=48,f.getOneIterator();case 48:return d=e.sent,c=!1,e.abrupt("return",d);case 51:e.next=57;break;case 53:return e.prev=53,e.t0=e.catch(3),c=!1,e.abrupt("return",Promise.reject(e.t0));case 57:case"end":return e.stop()}}),e,null,[[3,53]])})));return function(t){return e.apply(this,arguments)}}();return{bot:t,botState:i,prevBotState:o,setBotState:s,executeCommand:l}})),z=Object(h.a)(D,2),H=z[0],Y=z[1],F=r(306),Q=r(28),U=Object(f.a)((function(e){return{root:{justifyContent:"center",alignItems:"center",flexDirection:"column"},paperform:{width:"400px",margin:e.spacing(8,4),display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},paperlogging:{minWidth:"12vw",height:"9vh",display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",marginTop:"25vh",zIndex:e.zIndex.drawer+2},paperreconnect:{padding:"12px",minWidth:"20vw",height:"15vh",display:"flex",flexDirection:"column"},reconnectText:{},reconnectButton:{alignSelf:"flex-end"},form:{width:"80%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},signin:{marginTop:e.spacing(2)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},circle:{marginRight:"9px"}}}));function $(){var e=U(),t=P(),r=t.user,i=t.setUser,s=Y(),o=R(),c=o.setIsSnackbarOpen,u=o.setSnackbarContent,l=Object(Q.b)(),f=l.register,p=l.handleSubmit,j=function(){var e=Object(b.a)(m.a.mark((function e(t,r){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),n={username:t.username,password:t.password},e.next=4,C(n);case 4:e.sent&&((new S.a).set("user",n),i(n));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),C=Object(n.useCallback)(function(){var e=Object(b.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!1),A(!0),e.next=4,s.executeCommand({type:"login",arg:t});case 4:if(!e.sent){e.next=11;break}return N(!1),A(!1),e.abrupt("return",!0);case 11:return u({severity:"error",text:"\u5e33\u5bc6\u8f38\u5165\u932f\u8aa4\uff01\uff01"}),c(!0),H(!0),A(!1),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[s]),B=Object(n.useState)(!r),T=Object(h.a)(B,2),L=T[0],N=T[1],_=Object(n.useState)(!1),W=Object(h.a)(_,2),I=W[0],A=W[1],M=Object(n.useState)(!0),D=Object(h.a)(M,2),z=D[0],H=D[1],$=Object(n.useState)(!1),V=Object(h.a)($,2),q=V[0],G=V[1];return Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(r);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(r){if(void 0===s.prevBotState)return;s.botState.connect&&!s.prevBotState.connect?(G(!1),function(){e.apply(this,arguments)}()):s.prevBotState.connect&&!s.botState.connect&&(N(!0),G(!0))}}),[r,s.botState,s.prevBotState,C]),a.a.createElement(d.a,{container:!0,component:"main",className:e.root},I&&a.a.createElement(w.a,{className:e.paperlogging},a.a.createElement(F.a,{className:e.circle,color:"secondary"}),a.a.createElement(E.a,{variant:"body1"},s.connect?s.login?"":"\u767b\u5165\u4e2d":"\u9023\u7dda\u4e2d")),a.a.createElement(O.a,{className:e.backdrop,open:L},a.a.createElement(d.a,{container:!0,component:"main",className:e.root},a.a.createElement(y.a,null),q&&a.a.createElement(w.a,{className:e.paperreconnect},a.a.createElement(E.a,{variant:"body1",className:e.reconnectText},"\u60a8\u65b7\u7dda\u4e86"),a.a.createElement(v.a,{variant:"contained",color:"secondary",className:e.reconnectButton,onClick:function(){s.bot.reconnect()}},"\u91cd\u65b0\u9023\u7dda")),z&&a.a.createElement(w.a,{className:e.paperform},a.a.createElement(E.a,{component:"h4",variant:"h5",className:e.signin},"\u767b\u5165PTT"),a.a.createElement("form",{className:e.form,onSubmit:p(j)},a.a.createElement(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"\u5e33\u865f",name:"username",autoComplete:"username",autoFocus:!0,inputRef:f}),a.a.createElement(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u5bc6\u78bc",type:"password",id:"password",autoComplete:"current-password",inputRef:f}),a.a.createElement(x.a,{control:a.a.createElement(k.a,{value:"remember",color:"primary"}),label:"\u8a18\u4f4f\u6211"}),a.a.createElement(v.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"\u767b\u5165"))))))}r(154);var V=r(45),q=r.n(V),G=r(313),X=r(266),J=r(317),Z=r(316),K=r(98),ee=r.n(K),te=r(32);function re(e){return a.a.createElement(X.a,{disableGutters:!0,divider:!0,key:e.key},e.type?a.a.createElement(Z.a,{style:{flexBasis:"5%"},primary:e.type}):"",e.author?a.a.createElement(Z.a,{style:{flexBasis:"20%"},primary:e.author}):"",a.a.createElement(Z.a,{style:{flexBasis:"65%"},primary:e.text}),e.timestamp?a.a.createElement(Z.a,{style:{flexBasis:"10%"},primary:e.floor+"F",secondary:e.timestamp}):"")}function ne(e){var t=e.key,r=e.text;return a.a.createElement(X.a,{key:t,disableGutters:!0,style:{whiteSpace:"pre"}},a.a.createElement(Z.a,{primary:r}))}var ae=function(){var e=Object(b.a)(m.a.mark((function e(t,r){var n,a,i,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n={info:{id:"",aid:"",author:"",boardname:"",timestamp:"",title:"",ip:""},lines:[],iterator:null,sendComment:null}).info.boardname=t.boardname,n.info.id=t.id,n.info.title=t.title,n.info.author=t.author,e.next=8,ie(r,n);case 8:return a=e.sent,n.iterator=a.iterator,e.next=12,n.iterator.next();case 12:return(i=(i=e.sent).value).length>0&&i[0].str.includes("\u4f5c\u8005")&&(n.info.author=i[0].str.substring(4,50).trim(),n.info.timestamp=i[2].str.substring(3).trim(),i=i.slice(4)),s=oe(i,1,0),o=Object(h.a)(s,2),n.lines=o[0],n.commentStartFloor=o[1],n.sendComment=a.sendComment,e.abrupt("return",n);case 23:return e.prev=23,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 26:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,r){return e.apply(this,arguments)}}(),ie=function(){var e=Object(b.a)(m.a.mark((function e(t,r){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bot.select(te.Article).where("boardname",r.info.boardname).where("author",r.info.author).where("title",r.info.title).where("id",r.info.id),console.log("q",n),e.next=4,t.executeCommand({type:"contentIterator",arg:n});case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return",Promise.reject("getArticleResponse err."));case 7:return console.log(a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),se=function(){var e=Object(b.a)(m.a.mark((function e(t,r){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.bot.select(te.Article).where("boardname",r.boardname),r.id&&n.where("id",r.id),r.title&&n.where("title",r.title),r.author&&n.where("author",r.author),r.push&&n.where("push",r.push),e.next=8,t.executeCommand({type:"select",arg:n});case 8:return a=e.sent,e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r){return e.apply(this,arguments)}}(),oe=function(e,t,r){for(var n=[],a=0;a<e.length;a++){var i=e[a].str;if(i.match(/[\u63a8\u5653\u2192]\s+[\w\d]+\s*:.+/)){var s={type:"",author:"",text:"",timestamp:"",key:r};s.floor=t++,s.type=i[0],s.timestamp=i.substring(i.length-11);var o=i.indexOf(":");s.author=i.substring(2,o),s.text=i.substring(o+1,i.length-11),n.push(re(s))}else n.push(ne({text:i,key:r}));r++}return[n,t]};function ce(e){var t=e.item,r=e.info,n=e.BotContext,i=function(){var e=Object(b.a)(m.a.mark((function e(){var a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={boardname:t.name},r.setArticleList([]),r.sethaveSelectBoard(!0),e.next=6,n.executeCommand({type:"top"});case 6:return e.next=8,n.executeCommand({type:"index"});case 8:return e.next=10,se(n,a);case 10:i=e.sent,r.setArticleList(i),r.setBoardName(t.name),r.setIndex(0),r.setCriteria({}),r.setArticleSearchList([]),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(X.a,{button:!0,onClick:i,key:t.name,style:{height:"10vh"}},a.a.createElement(Z.a,{primary:a.a.createElement(E.a,{variant:"body1"},t.name),secondary:a.a.createElement(E.a,{variant:"body2"},t.title)}),a.a.createElement(J.a,{style:{justifyContent:"center"}},a.a.createElement(ee.a,null)))}var ue=Object(j.a)((function(){Y();var e=Object(n.useState)(""),t=Object(h.a)(e,2),r=t[0],a=t[1],i=new n.useState({info:{id:"",aid:"",author:"",boardname:"",timestamp:"",title:""},lines:[],iterator:null}),s=Object(h.a)(i,2),o=s[0],c=s[1],u=Object(n.useState)([]),l=Object(h.a)(u,2),f=l[0],d=l[1],p=Object(n.useState)(0),m=Object(h.a)(p,2),b=m[0],v=m[1],y=Object(n.useState)([]),g=Object(h.a)(y,2),x=g[0],k=g[1],w=Object(n.useState)({}),E=Object(h.a)(w,2),O=E[0],S=E[1],j=Object(n.useState)(!1),C=Object(h.a)(j,2);return{boardName:r,setBoardName:a,article:o,setArticle:c,articleList:f,setArticleList:d,index:b,setIndex:v,articleSearchList:x,setArticleSearchList:k,criteria:O,setCriteria:S,haveSelectBoard:C[0],sethaveSelectBoard:C[1]}})),le=Object(h.a)(ue,2),fe=le[0],de=le[1];function he(e){var t=Object(f.a)((function(e){return{root:{alignItems:"center",justifyContent:"center",maxHeight:"80vh",height:"80vh",overflow:"auto",alignContent:"flex-start"},skeleton:{fontSize:"40px",width:"80%"},list:{padding:"0px",width:"100%"}}}))(),r=P().user,i=Y(),s=Object(n.useState)([]),o=Object(h.a)(s,2),c=o[0],u=o[1],l=de(),p=Object(n.useRef)(null),v=Object(n.useRef)(null),y=Object(n.useRef)({}),g=e.selectedBoard,x=e.searchBoardText,k=Object(n.useCallback)(Object(b.a)(m.a.mark((function e(){var t,r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.length>0?y.current[x]?t=y.current[x]:r=i.bot.select(te.Board).where("prefix",x):"hot"===g&&p.current?t=p.current:"favorite"===g&&v.current?t=v.current:r="hot"===g?i.bot.select(te.Board).where("entry","hot"):i.bot.select(te.Board).where("entry","favorite"),t){e.next=12;break}return performance.now(),e.next=5,i.executeCommand({type:"select",arg:r});case 5:if(n=e.sent,performance.now(),n){e.next=9;break}return e.abrupt("return",!1);case 9:t=n.map((function(e){return ce({item:e,info:l,BotContext:i})})),performance.now(),0===x.length?"hot"===g?p.current=t:"favorite"===g&&(v.current=t):y.current[x]=t;case 12:u(t);case 13:case"end":return e.stop()}}),e)}))),[i,u,g,l,x]);return Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.botState.login&&function(){e.apply(this,arguments)}()}),[i.botState.login,g,x]),a.a.createElement(d.a,{container:!0,component:"main",className:t.root},a.a.createElement(d.a,{item:!0,className:t.skeleton},0===x.length&&0===c.length&&a.a.createElement(q.a,{count:6})),c&&a.a.createElement(G.a,{className:t.list}," ",c," "),!c&&"")}var pe=r(328),me=r(318),be=r(315),ve=r(76),ye=r.n(ve),ge=r(164),xe=r(319);function ke(e){var t=Object(f.a)((function(e){return{skeleton:{fontSize:"24px",width:"80%"},root:{justifyContent:"center",alignItems:"center"},select:{display:"flex",flexDirection:"column",width:"100%"},tabs:{flexBasis:"85%"},tab:{fontSize:"0.8rem",minWidth:"50%"},searchBotton:{flexBasis:"15%"},btntabs:{width:"100%",display:"flex"},inputbase:{}}}))(),r=Y(),i=Object(n.useState)(0),s=Object(h.a)(i,2),o=s[0],c=s[1],u=Object(n.useState)(!1),l=Object(h.a)(u,2),p=l[0],m=l[1],b=e.setSelectedBoard,v=e.setSearchBoardText;return Object(n.useEffect)((function(){var e="hot";switch(o){case 0:e="hot";break;case 1:e="favorite"}b(e)}),[o,b]),a.a.createElement(d.a,{container:!0,component:"main",className:t.root},a.a.createElement(d.a,{item:!0,className:t.skeleton},!r.botState.login&&a.a.createElement(q.a,{count:1})),r.botState.login&&a.a.createElement(d.a,{item:!0,className:t.select},a.a.createElement(d.a,{item:!0,className:t.btntabs},a.a.createElement(be.a,{color:"primary","aria-label":"search board",className:t.searchBotton,onClick:function(){m((function(e){return!e}))}},a.a.createElement(ye.a,null)),a.a.createElement(pe.a,{value:o,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){c(t)},className:t.tabs,variant:"scrollable"},a.a.createElement(me.a,{wrapped:!0,label:"\u71b1\u9580\u770b\u677f",className:t.tab}),a.a.createElement(me.a,{wrapped:!0,label:"\u6700\u611b\u770b\u677f",className:t.tab}))),a.a.createElement(xe.a,{in:p},a.a.createElement(ge.a,{onChange:function(e){v(e.target.value)},placeholder:"\u641c\u5c0b\u770b\u677f",className:t.inputbase}))))}function we(){var e=Object(f.a)((function(e){return{root:{position:"relative",display:"flex",borderRight:"1px solid ".concat(e.palette.divider),justifyContent:"center",alignItems:"center",maxHeight:"90vh",height:"90vh",overflow:"auto"}}}))(),t=Object(n.useState)("hot"),r=Object(h.a)(t,2),i=r[0],s=r[1],o=Object(n.useState)(""),c=Object(h.a)(o,2),u=c[0],l=c[1];return a.a.createElement(d.a,{container:!0,component:"main",className:e.root},a.a.createElement(ke,{setSelectedBoard:s,setSearchBoardText:l}),a.a.createElement(he,{selectedBoard:i,searchBoardText:u}))}var Ee=r(156),Oe=r.n(Ee),Se=r(13),je=r(99),Ce=r.n(je),Be=r(320),Te=r(311),Le=r(327),Pe=r(321),Ne=r(157),_e=r.n(Ne),We=r(335);function Ie(e){var t=Object(f.a)((function(e){return{root:{width:"100%",paddingLeft:"4vw",paddingRight:"2vw",paddingBottom:"12px",paddingTop:"12px",minHeight:"12vh"},divider:{height:"100%",margin:4},type:{flexBasis:"10%"},text:{flexBasis:"75%"},form:{width:"100%",display:"flex"},button:{fontSize:"0.6rem",height:"fit-content",flexBasis:"10%",alignSelf:"center"},sending:{flexBasis:"5%",alignSelf:"center",marginLeft:"4px"},lp:{width:"100%"}}})),r=de(),i=r.article,s=e.setHasMore,o=t(),c=Y(),u=Object(n.useState)(!1),l=Object(h.a)(u,2),p=l[0],y=l[1],x=Object(Q.b)(),k=x.handleSubmit,w=x.control,E=function(){var e=Object(b.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=(n=t.text).trim()).length){e.next=4;break}return e.abrupt("return");case 4:return y(!0),a={type:t.type,text:n,boardName:i.info.boardname,aid:i.info.aid},e.prev=6,e.next=9,i.sendComment(a,c.bot);case 9:i.iterator.reset(),r.setArticle(Object(N.a)({},i,{lines:[],commentStartFloor:1})),s(!0),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(6),console.error(e.t0),e.abrupt("return");case 18:y(!1);case 19:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(d.a,{container:!0,component:"main",className:o.root},a.a.createElement("form",{onSubmit:k(E),className:o.form,noValidate:!0,autoComplete:"off"},a.a.createElement(Te.a,{className:o.type},a.a.createElement(We.a,null,"\u985e\u578b"),a.a.createElement(Q.a,{as:a.a.createElement(Le.a,null,a.a.createElement(Be.a,{value:"1"},"\u63a8"),a.a.createElement(Be.a,{value:"2"},"\u5653"),a.a.createElement(Be.a,{value:"3"},"\u2192")),name:"type",rules:{required:"this is required"},control:w,defaultValue:"1"})),a.a.createElement(Pe.a,{className:o.divider,orientation:"vertical"}),a.a.createElement(Q.a,{className:o.text,as:a.a.createElement(g.a,{label:"\u5167\u5bb9",multiline:!0}),rules:{required:!0},name:"text",control:w,defaultValue:""}),a.a.createElement(v.a,{variant:"contained",color:"primary",className:o.button,endIcon:a.a.createElement(_e.a,null),type:"submit"},"\u9001\u51fa"),a.a.createElement(d.a,{item:!0,className:o.sending},p&&a.a.createElement(F.a,{size:"1rem"}))))}var Ae=r(67),Me=r.n(Ae),Re=function(e,t){return(Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var De=function(){return(De=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var ze="Pixel",He="Percent",Ye={unit:He,value:.8};var Fe=function(e){function t(t){var r=e.call(this,t)||this;return r.lastScrollTop=0,r.actionTriggered=!1,r.startY=0,r.currentY=0,r.dragging=!1,r.maxPullDownDistance=0,r.getScrollableTarget=function(){return r.props.scrollableTarget instanceof HTMLElement?r.props.scrollableTarget:"string"===typeof r.props.scrollableTarget?document.getElementById(r.props.scrollableTarget):(null===r.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},r.onStart=function(e){r.lastScrollTop||(r.dragging=!0,console.log("dragging..."),e instanceof MouseEvent?r.startY=e.pageY:e instanceof TouchEvent&&(r.startY=e.touches[0].pageY),r.currentY=r.startY,console.log("this.currentY",r.currentY),r._infScroll&&(r._infScroll.style.willChange="transform",r._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},r.onMove=function(e){r.dragging&&(e instanceof MouseEvent?r.currentY=e.pageY:e instanceof TouchEvent&&(r.currentY=e.touches[0].pageY),console.log("dragging..."),r.currentY<r.startY||(r.currentY-r.startY>=Number(r.props.pullDownToRefreshThreshold)&&r.setState({pullToRefreshThresholdBreached:!0}),r.currentY-r.startY>1.5*r.maxPullDownDistance||r._infScroll&&(r._infScroll.style.overflow="visible",r._infScroll.style.transform="translate3d(0px, "+(r.currentY-r.startY)+"px, 0px)")))},r.onEnd=function(){r.startY=0,r.currentY=0,r.dragging=!1,r.state.pullToRefreshThresholdBreached&&r.props.refreshFunction&&r.props.refreshFunction(),requestAnimationFrame((function(){r._infScroll&&(r._infScroll.style.overflow="auto",r._infScroll.style.transform="none",r._infScroll.style.willChange="none")}))},r.onScrollListener=function(e){"function"===typeof r.props.onScroll&&setTimeout((function(){return r.props.onScroll&&r.props.onScroll(e)}),0);var t=r.props.height||r._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;r.actionTriggered||(r.isElementAtBottom(t,r.props.scrollThreshold)&&r.props.hasMore&&(r.actionTriggered=!0,r.setState({showLoader:!0}),r.props.next&&r.props.next()),r.lastScrollTop=t.scrollTop)},r.state={showLoader:!1,pullToRefreshThresholdBreached:!1},r.throttledOnScrollListener=function(e,t,r,n){var a,i=!1,s=0;function o(){a&&clearTimeout(a)}function c(){var c=this,u=Date.now()-s,l=arguments;function f(){s=Date.now(),r.apply(c,l)}function d(){a=void 0}i||(n&&!a&&f(),o(),void 0===n&&u>e?f():!0!==t&&(a=setTimeout(n?d:f,void 0===n?e-u:e)))}return"boolean"!==typeof t&&(n=r,r=t,t=void 0),c.cancel=function(){o(),i=!0},c}(150,r.onScrollListener).bind(r),r.onStart=r.onStart.bind(r),r.onMove=r.onMove.bind(r),r.onEnd=r.onEnd.bind(r),r}return function(e,t){function r(){this.constructor=e}Re(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.key===e.key&&this.props.dataLength===e.dataLength||(this.actionTriggered=!1,this.setState({showLoader:!1,pullToRefreshThresholdBreached:!1}))},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var r=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,n=function(e){return"number"===typeof e?{unit:He,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:ze,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:He,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),Ye):(console.warn("scrollThreshold should be string or number"),Ye)}(t);return n.unit===ze?e.scrollTop+r>=e.scrollHeight-n.value:e.scrollTop+r>=n.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=De({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),r=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),n=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto",width:"100%"}:{width:"100%"};return Me.a.createElement("div",{style:n,className:"infinite-scroll-component__outerdiv"},Me.a.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&Me.a.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},Me.a.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!r&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(Ae.Component);function Qe(e){var t=Object(f.a)((function(e){return{root:{alignItems:"center",maxHeight:"90vh",height:"90vh",overflow:"auto"},skeleton:{fontSize:"40px",width:"80%"},top:{height:"20vh",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",marginTop:"12px",flexWrap:"nowrap",paddingLeft:"4vw"},goback:{width:"4vw",top:0,position:"absolute",zIndex:1001},info:{},titleText:{alignSelf:"center",flexBasis:"100%",flexGrow:"0",flexShrink:"0"},sendComment:{position:"absolute",bottom:0,backgroundColor:e.palette.background.paper},author:{alignSelf:"center"},scrollBottom:{paddingBottom:"12vh"},infScroll:{overflow:"inherit",paddingTop:0,width:"100%",paddingLeft:"4vw",paddingRight:"2vw"}}})),r=de(),i=r.article,s=t(),o=Y(),c=a.a.createRef(),u=Object(n.useState)(!0),l=Object(h.a)(u,2),p=l[0],v=l[1];Object(n.useEffect)((function(){2===r.index?c.current.scrollTop=0:(console.log("exit display"),v(!0))}),[r.index]);var g=function(){var e=Object(b.a)(m.a.mark((function e(){var t,n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loadmore"),e.prev=1,performance.mark("iterator.next()"),e.next=5,i.iterator.next();case 5:if(t=e.sent,performance.mark("iterator.next() finished"),console.log("res",t),!t.done){e.next=11;break}return v(!1),e.abrupt("return");case 11:t=t.value,performance.mark("parseLines"),n=oe(t,i.commentStartFloor,i.lines.length),performance.mark("parseLines finished"),a=[].concat(Object(Se.a)(i.lines),Object(Se.a)(n[0])),s=n[1],console.log("article",i),console.log("newLines",a),console.log("newCommentStartFloor",s),performance.mark("setArticle"),r.setArticle(Object(N.a)({},i,{lines:a,commentStartFloor:s})),performance.mark("setArticle finished"),performance.measure("iterator","iterator.next()","iterator.next() finished"),performance.measure("parselines","parseLines","parseLines finished"),performance.measure("setarticle","setArticle","setArticle finished"),performance.getEntriesByType("measure").forEach((function(e){console.log(e)})),performance.clearMarks(),performance.clearMeasures(),v(!0),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(1),console.error(e.t0);case 35:case"end":return e.stop()}}),e,null,[[1,32]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(d.a,{container:!0,ref:c,component:"main",id:"scrollableDiv2",className:s.root},a.a.createElement(y.a,null),r.index?a.a.createElement(be.a,{onClick:Object(b.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.executeCommand({type:"top"});case 2:return e.next=4,o.executeCommand({type:"index"});case 4:v(!0),r.setIndex(r.articleSearchList.length>0?1:0);case 6:case"end":return e.stop()}}),e)}))),className:s.goback},a.a.createElement(Ce.a,null)):"",a.a.createElement(d.a,{container:!0,className:s.top},a.a.createElement(d.a,{container:!0,className:s.info},a.a.createElement(E.a,{className:s.author,variant:"body1"},i.info.author),a.a.createElement(E.a,{variant:"h5",className:s.titleText},i.info.title),a.a.createElement(E.a,{className:s.boardName,variant:"body2"},i.info.boardname),a.a.createElement(E.a,{className:s.timestamp,variant:"body2"},"\u30fb",i.info.timestamp))),a.a.createElement(Fe,{className:s.infScroll,scrollableTarget:"scrollableDiv2",dataLength:i.lines.length,next:g,hasMore:p,loader:a.a.createElement(F.a,{color:"secondary",size:12,className:s.loading})},i.lines),a.a.createElement(d.a,{container:!0,className:s.scrollBottom}),a.a.createElement(d.a,{container:!0,className:s.sendComment},a.a.createElement(Ie,{setHasMore:v})))}function Ue(e){var t=e.item,r=e.info,n=e.BotContext,i=function(){var e=Object(b.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.title.startsWith("(\u672c\u6587\u5df2\u88ab\u522a\u9664)")){e.next=2;break}return e.abrupt("return");case 2:if(!t.author.startsWith("-")){e.next=4;break}return e.abrupt("return");case 4:return console.log("article item click:",r,t,n),e.prev=5,performance.mark("handleClick"),e.next=9,ae(t,n);case 9:a=e.sent,console.log("article",a),performance.mark("setArticle"),r.setIndex(2),r.setArticle(a),performance.measure("handleclick","handleClick"),performance.measure("setArticle","setArticle"),performance.getEntriesByType("measure").forEach((function(e){console.log(e)})),performance.clearMarks(),performance.clearMeasures(),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),console.error(e.t0);case 24:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(X.a,{onClick:i,button:!0,key:t.id,divider:!0,style:{height:"10vh"}},a.a.createElement(X.a,{style:{flexBasis:"15%",flexGrow:"0",flexShrink:"0"}},a.a.createElement(Z.a,{primary:a.a.createElement(E.a,{variant:"body2"},t.push)}),"R:"===t.status&&a.a.createElement(Z.a,{primary:a.a.createElement(E.a,{variant:"body2"},"RE:"),style:{textAlign:"right"}})),a.a.createElement(Z.a,{primary:a.a.createElement(E.a,{variant:"body1"},t.title),secondary:a.a.createElement(E.a,{variant:"body2"},t.author),style:{flexBasis:"60%",flexGrow:"0",flexShrink:"0"}}),a.a.createElement(Z.a,{primary:a.a.createElement(E.a,{variant:"body2"},t.date),secondary:a.a.createElement(E.a,{variant:"body2"},"id:",t.id)}),a.a.createElement(J.a,{style:{justifyContent:"center"}},a.a.createElement(ee.a,null)))}var $e=r(323),Ve=r(322),qe=r(158),Ge=r.n(qe);function Xe(e){var t=Object(f.a)((function(e){return{root:{alignItems:"center",justifyContent:"center",maxHeight:"90vh",height:"90vh",overflow:"auto"},skeleton:{fontSize:"40px",width:"80%"},info:{position:"absolute",right:"0",backgroundColor:"rgba(0,0,0,0.1)"},searchFab:{position:"absolute",right:"1vw",bottom:"1vh",zIndex:"1001"},backdrop:{zIndex:e.zIndex.drawer+1},paper:{flexDirection:"column"},form:{width:"40vw",margin:"12px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},button:{alignSelf:"flex-end",marginTop:"12px"},title:{alignSelf:"flex-start",width:"90%",margin:"12px"},author:{alignSelf:"flex-start",width:"90%",margin:"12px"},push:{alignSelf:"flex-start",width:"90%",margin:"12px"},closeIcon:{position:"absolute",margin:"12px"},saTitle:{textAlign:"center",margin:"24px"},list:{width:"100%"}}}))(),r=de(),i=Y(),s=Object(n.useState)(!1),o=Object(h.a)(s,2),c=o[0],u=o[1],l=Object(n.useState)([]),p=Object(h.a)(l,2),x=p[0],k=p[1],S=R(),j=S.setIsSnackbarOpen,C=S.setSnackbarContent;Object(n.useEffect)((function(){if(r.articleList.length>0){var e=r.articleList.map((function(e){return Ue({item:e,info:r,BotContext:i})}));k(e)}}),[r]);var B=function(){u((function(e){return!e}))},T=Object(Q.b)(),L=T.handleSubmit,P=T.control,N=T.errors,_=function(){var e=Object(b.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={boardname:r.boardName,title:t.title,author:t.author,push:t.push},r.setCriteria(n),e.prev=2,e.next=5,se(i,n);case 5:a=e.sent,console.log(a),a.length>0?(r.setArticleSearchList(a),r.setIndex(1)):(j(!0),C({severity:"error",text:"\u641c\u5c0b\u4e0d\u5230\u6771\u897f\uff01"}),r.setCriteria({})),B(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(d.a,{container:!0,component:"main",className:t.root,id:"scrollableDiv"},a.a.createElement(y.a,null),a.a.createElement(d.a,{item:!0,className:t.skeleton,alignItems:"center",justify:"center",alignContent:"center"},0===r.articleList.length&&(r.haveSelectBoard?a.a.createElement(d.a,{container:!0,className:t.skeleton,alignItems:"center",justify:"center",alignContent:"center"},a.a.createElement(F.a,{className:t.circle,color:"secondary"})):a.a.createElement(q.a,{count:3}))),r.articleList.length>0&&a.a.createElement(d.a,{container:!0,className:t.list},a.a.createElement(O.a,{className:t.backdrop,open:c,invisible:!0},a.a.createElement(Ve.a,{mouseEvent:!!c&&"onClick",onClickAway:B},a.a.createElement(w.a,{elevation:4,className:t.paper},a.a.createElement(be.a,{className:t.closeIcon,onClick:B},a.a.createElement(Ge.a,null)),a.a.createElement(E.a,{className:t.saTitle},"\u641c\u5c0b\u6587\u7ae0"),a.a.createElement(Pe.a,{className:t.divider,orientation:"horizontal"}),a.a.createElement("form",{onSubmit:L(_),className:t.form,noValidate:!0,autoComplete:"off"},a.a.createElement(Q.a,{className:t.title,as:a.a.createElement(g.a,{label:"\u6a19\u984c"}),name:"title",control:P,defaultValue:""}),a.a.createElement(Q.a,{className:t.author,as:a.a.createElement(g.a,{label:"\u4f5c\u8005"}),name:"author",control:P,defaultValue:""}),a.a.createElement(Q.a,{className:t.push,as:a.a.createElement(g.a,{label:"\u63a8\u6578(\u5927\u65bc\u591a\u5c11)",helperText:N.length>0?"\u5fc5\u9808\u662f\u6578\u5b57":"",error:N.length>0}),rules:{pattern:{value:/\b\d{0,6}\b/}},name:"push",control:P,defaultValue:""}),a.a.createElement(v.a,{variant:"contained",color:"primary",className:t.button,type:"submit"},"\u9001\u51fa"))))),a.a.createElement(d.a,{item:!0,className:t.info},"\u770b\u677f\uff1a",r.boardName),a.a.createElement($e.a,{color:"secondary",className:t.searchFab},a.a.createElement(ye.a,{onClick:B})),a.a.createElement(Fe,{style:{overflow:"inherit"},scrollableTarget:"scrollableDiv",dataLength:x.length,next:function(){if(0!==r.articleList.length){var e=r.articleList[r.articleList.length-1].id,t=i.bot.select(te.Article).where("boardname",r.boardName).where("id",e);i.executeCommand({type:"select",arg:t}).then((function(t){if(!t)return!1;var n=t.reduce((function(t,r){return r.id<e&&t.push(r),t}),[]);r.setArticleList([].concat(Object(Se.a)(r.articleList),Object(Se.a)(n)))}))}},hasMore:!0,loader:a.a.createElement(F.a,{color:"secondary",size:12,className:t.loading})},x)))}function Je(e){var t=Object(f.a)((function(e){return{root:{alignItems:"center",justifyContent:"center",maxHeight:"90vh",height:"90vh",overflow:"auto"},skeleton:{fontSize:"40px",width:"80%"},info:{height:"fit-content",backgroundColor:"rgba(0,0,0,0.1)"},goback:{width:"4vw",zIndex:1001},buttoninfo:{top:"0",display:"flex",width:"100%",position:"absolute",justifyContent:"space-between"}}}))(),r=de(),i=Y(),s=Object(n.useState)([]),o=Object(h.a)(s,2),c=o[0],u=o[1];Object(n.useEffect)((function(){if(r.articleSearchList.length>0){var e=r.articleSearchList.map((function(e){return Ue({item:e,info:r,BotContext:i})}));u(e)}}),[r.articleSearchList]);var l=function(){var e=Object(b.a)(m.a.mark((function e(){var t,n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.articleSearchList[r.articleSearchList.length-1].id,(n=r.criteria).id=t,e.prev=3,e.next=6,se(i,n);case 6:a=e.sent,s=a.reduce((function(e,r){return r.id<t&&e.push(r),e}),[]),r.setArticleSearchList([].concat(Object(Se.a)(r.articleSearchList),Object(Se.a)(s))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}();return 1!==r.index?null:a.a.createElement(d.a,{container:!0,component:"main",className:t.root,id:"scrollableDiv1"},a.a.createElement(y.a,null),a.a.createElement(d.a,{className:t.buttoninfo,item:!0},a.a.createElement(be.a,{onClick:function(){var e=Object(b.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.executeCommand({type:"index"});case 2:r.setIndex(0),r.setArticleSearchList([]),r.setCriteria({});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),className:t.goback},a.a.createElement(Ce.a,null)),a.a.createElement(d.a,{item:!0,className:t.info},r.criteria.boardname?"\u770b\u677f\uff1a".concat(r.criteria.boardname):"",r.criteria.title?"\uff0e\u6a19\u984c\uff1a".concat(r.criteria.title):"",r.criteria.author?"\uff0e\u4f5c\u8005\uff1a".concat(r.criteria.author):"",r.criteria.push?"\uff0e\u8b9a\u6578\uff1a".concat(r.criteria.push):"")),a.a.createElement(Fe,{style:{overflow:"inherit"},scrollableTarget:"scrollableDiv1",dataLength:c.length,next:l,scrollThreshold:.5,hasMore:r.articleSearchList.length>0&&r.articleSearchList[r.articleSearchList.length-1].id>1,loader:a.a.createElement(F.a,{color:"secondary",size:12,className:t.loading})},c))}function Ze(){var e=Object(f.a)((function(e){return{root:{width:"100%"},skeleton:{fontSize:"40px",width:"80%"}}})),t=de(),r=e();return a.a.createElement(Oe.a,{index:t.index,onChangeIndex:function(e){t.setIndex(e)},className:r.root},a.a.createElement(Xe,null),a.a.createElement(Je,null),a.a.createElement(Qe,null))}var Ke=r(324),et=Object(f.a)((function(e){return{toolbar:{boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",transition:"all 0.3s cubic-bezier(.25,.8,.25,1)",position:"sticky",display:"flex"},toolbarTitle:{flex:1},toolbarSecondary:{justifyContent:"space-between",overflowX:"auto"},toolbarLink:{padding:e.spacing(1),flexShrink:0},title:{fontFamily:"Crimson Text",fontSize:"32px",marginRight:"16vw"}}}));function tt(e){var t=et();return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ke.a,{className:t.toolbar,boxShadow:1},a.a.createElement("div",{className:t.title},"ModernPTT")))}var rt=r(326),nt=r(333),at=r(329),it=Object(f.a)((function(e){return{}}));function st(){it();var e=R(),t=e.isSnackbarOpen,r=e.setIsSnackbarOpen,n=e.snackbarContent;function i(e){return a.a.createElement(at.a,Object.assign({elevation:6,variant:"filled"},e))}return a.a.createElement(nt.a,{open:t,autoHideDuration:1e3,onClose:function(e,t){"clickaway"!==t&&r(!1)}},a.a.createElement(i,{severity:n.severity},n.text))}var ot=r(160),ct=r(325),ut=r(159),lt=Object(ot.a)({typography:{body1:{fontSize:"0.8rem"},body2:{fontSize:"0.65rem"},h5:{fontSize:"1rem",fontWeight:"bold"}},palette:{type:"dark",primary:{dark:"#7986cb",main:"#33c9dc"}}}),ft=Object(f.a)((function(e){return{resizable:{display:"flex",width:"100%"}}}));function dt(){var e=ft();return a.a.createElement(L,null,a.a.createElement(M,null,a.a.createElement(H,null,a.a.createElement(fe,null,a.a.createElement(ct.a,{theme:lt},a.a.createElement(rt.a,{component:"main",maxWidth:"lg",disableGutters:"true"},a.a.createElement(y.a,null),a.a.createElement($,null),a.a.createElement(d.a,{container:!0},a.a.createElement(d.a,{item:!0,xs:12},a.a.createElement(tt,null)),a.a.createElement(d.a,{item:!0,className:e.resizable},a.a.createElement(ut.Resizable,{defaultSize:{width:"25vw",height:"100%"},enable:{top:!1,right:!0,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1}},a.a.createElement(we,null)),a.a.createElement(Ze,null)),a.a.createElement(st,null))))))))}var ht=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){return a.a.createElement(dt,null)}}]),r}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(ht,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},32:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Article",{enumerable:!0,get:function(){return n.Article}}),Object.defineProperty(t,"Board",{enumerable:!0,get:function(){return a.Board}}),Object.defineProperty(t,"Mail",{enumerable:!0,get:function(){return i.Mail}});var n=r(239),a=r(241),i=r(242)},89:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"decode",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"encode",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"keymap",{enumerable:!0,get:function(){return s.default}});var a=n(r(231)),i=n(r(232)),s=n(r(233))},90:function(e,t,r){"use strict";var n=r(22);Object.defineProperty(t,"__esModule",{value:!0}),t.dbcswidth=i,t.getWidth=s,t.indexOfWidth=o,t.substrWidth=function(e,t,r,n){var a="undefined"===typeof n,i=n,c=r,u=0,l=0;"length"!==e&&(c=o(e,t,r),s(e,t.substr(0,c))<r&&(c+=1,u=Math.max(s(e,t.substr(0,c))-r,0)),a||(i=o(e,t.substr(c),n-u),l=Math.min(n,s(e,t.substr(c)))-(u+s(e,t.substr(c,i)))));var f=a?t.substr(c):t.substr(c,i);return" ".repeat(u)+f+" ".repeat(l)};var a=n(r(123));function i(e){return e.split("").reduce((function(e,t){return e+(t.charCodeAt(0)>255?2:1)}),0)}function s(e,t){switch(e){case"length":return t.length;case"wcwidth":return(0,a.default)(t);case"dbcs":return i(t);default:throw new Error('Invalid widthType "'.concat(e,'"'))}}function o(e,t,r){if("length"===e)return Math.min(r,t.length);for(var n=0;n<=t.length;n++)if(s(e,t.substr(0,n))>r)return n-1;return t.length}}},[[179,1,2]]]);
//# sourceMappingURL=main.a916c0c2.chunk.js.map